数据结构课程设计报告

# 需求分析

我将需求分为用户角度和程序设计角度两个方面。

## 用户角度

用户角度从用户体验角度出发，不包含技术层面内容。

### 1. 交互与操作方式

用户希望拥有直观且智能的操作体验，无需学习复杂的指令或编程语法：

- **图形化交互（GUI 操作）**：用户可以通过直观的人机界面（如点击按钮、菜单选择、拖拽节点等）来手工构建数据结构并触发算法演示，操作过程所见即所得。
- **自然语言交互（AI 助手）**：用户可以用日常的自然语言描述需求（例如：“创建一个包含数字 [5, 3, 7, 2, 4] 的二叉搜索树”），系统应能智能理解意图，自动绘制出对应的数据结构并进行演示。

### 2. 线性结构的可视化

用户需要看到线性的数据排布，并动态演示数据的增删改查过程：

- **线性表**：
  - 支持顺序表和链表两种形式。
  - 用户可以执行构建列表、插入新元素、删除旧元素的操作，并看到相应的动画变化。
- **栈**：
  - 展示顺序栈的结构。
  - 用户可以执行入栈和出栈操作，观察数据如何进出。

### 3. 树形结构的可视化

用户需要直观地看到树的节点连接方式，以及复杂的树形算法变化过程：

- **普通二叉树**：展示其链式结构的构建过程。
- **二叉搜索树**：
  - 演示构建过程。
  - 演示查找特定值的路径（高亮显示查找路线）。
  - 演示删除节点后的结构调整。
- **哈夫曼树**：演示如何从一堆权重节点逐步构建成一棵哈夫曼树的过程。
- **平衡二叉树**：演示在构建过程中，树是如何自动旋转以保持平衡的。

### 4. 视觉体验与反馈

用户对界面的直观性和美观度有要求：

- **图形化界面**：必须是生动的图形展示（节点、连线、箭头），不能只是黑底白字的控制台文本。
- **动态动画**：当执行算法（如插入、删除、查找、旋转）时，用户能看到连续的动画演示，而不是瞬间变结果（例如看到指针的移动、节点的消失或位置变换）。
- **良好布局**：无论树或表的数据多少，生成的图形应当布局合理、整洁，保证信息完整且易于阅读。

### 5. 数据管理与辅助功能

用户希望保存工作进度以便后续学习：

- **保存与加载**：用户可以将当前绘制好的数据结构保存下来，下次打开软件时能读取并继续编辑。
- **自动化绘图**：支持通过导入历史数据直接生成图形，无需手动一个个画节点。

## 程序设计角度

### 1. 程序需要完成功能

- **数据结构操作**：内置顺序表（数组）、顺序栈、普通二叉树、二叉搜索树（后续可扩展 AVL、哈夫曼等）。每一种结构都要支持初始化、插入、删除、更新等基本操作，并在运行前做参数合法性校验（例如数组容量、栈是否为空、二叉树子节点是否占用等）。
- **原子/用户/复合操作机制**：所有动作都拆解成 `AtomicOperation`，由 `UserOperation` 组合，再由 `CompositeUserOperation` 构建复杂流程，确保可执行、可撤销、可序列化，便于动画播放。
- **可视化播放**：通过 ImGui 渲染画布显示节点、边、箭头及高亮信息。播放控制器支持单步执行、回退、拖动时间轴、自动播放，以及对复合操作的分层计数显示。
- **节点交互**：在树的渲染面板中可以直接通过鼠标“拾取”节点，自动填充到操作面板的输入框，避免手动输入 UUID。
- **操作历史**：提供全局的撤销/重做栈，保持最新状态与可重放的上一步状态；一旦执行初始化，会清空历史，以免出现无法恢复的旧结构。
- **状态对齐**：每次运行新操作都会自动切换到对应的数据结构可视化面板，确保用户在正确的画布上进行节点选择和结果观察。

### 2. 需要处理的数据

- **结构数据**：数组（顺序存储）、栈（顺序栈 top 指针）、树（节点 UUID、左右孩子指针、临时节点等）。每种结构都实现统一的 `DataStructure` 接口，并提供 `clear()` 方法供初始化操作复位。
- **操作数据**：`AtomicOperation` 保存执行/撤销所需的旧值、新值、节点 UUID 等；`UserOperation` 维护一组原子操作的顺序、当前步数；`CompositeUserOperation` 保存子操作列表及当前子序号。
- **可视化数据**：`HighlightInfo`、`HighlightVisitor` 收集每一步需要高亮的节点、索引、箭头、临时槽位等信息，供渲染层使用。
- **历史数据**：`OperationHistoryEntry` 记录描述、时间戳、状态（进行中/完成/已撤销），以及全局撤销/重做索引，确保可以正确回溯。

### 3. 开发与运行环境

- **语言与工具链**：Java 8、Gradle 8.14、LWJGL + ImGui Java binding（`io.github.spair:imgui-java-app:1.90.0`）。
- **操作系统**：已验证可在 Windows（GLFW）和 Linux（Wayland 需禁用窗口定位）运行。
- **调试输出**：`Main.DEBUG` 控制数据结构的调试打印，便于在控制台观察状态变化。
- **依赖管理**：使用 Gradle 统一拉取 ImGui/LWJGL 与其它基础库，`gradlew` 跨平台执行构建与打包。

### 4. 用户界面设计

- **操作构建面板**：以 Tab 形式区分 Array、Stack、Binary Tree、BST；每个 Tab 都提供与构造器一致的输入控件（例如逗号分隔的初始值、索引滑块、值输入框、节点拾取按钮等）。当播放进行中时整块面板会禁用。
- **可视化面板**：根据当前激活的数据结构自动切换渲染器（数组/栈/树）。树节点带有自适应布局、悬浮高亮、点击拾取，并在节点中心绘制白色数值、黑色遮挡层，防止连线穿过文字。
- **播放控制面板**：展示整体状态（Idle/In Progress）、操作描述、复合操作子任务进度、单步前进/后退按钮、时间轴滑块等，并在每步后实时刷新高亮信息。
- **操作历史面板**：采用时间顺序列表展示所有操作记录，顶部提供全局 Undo/Redo 按钮；历史条目显示名称与状态，并允许在非进行中状态下重新可视化对应操作。

# 数据结构设计

%%
课程设计报告在这部分至少应包括：
⑴ 所定义主要的数据结构。
⑵ 程序整体结构以及各模块的功能描述。
%%